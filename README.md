# PageSeeder Email SDK

This is a simple framework to help developers create customized email templates for PageSeeder.

It is mainly used to accelerate the development and testing of email templates.

For more info on PageSeeder emails see [PageSeeder Email API](https://dev.pageseeder.com/guide/configuration/emails.html)

## Get started

First, you need to update the details of your PageSeeder installation 
in the `gradle.properties file` so that the generated emails use the correct 
email domain and URLs. 

```
  # Define the Email domain of your server
  emailDomain=pageseeder.localhost

  # Define the host URL of your PageSeeder server
  hostURL=https://pageseeder.localhost:8443/ps/

  # Define where PageSeeder is installed locally
  localPageSeeder=C:/PageSeeder/default
  localProject=myproject
```

## Generate the HTML emails

To generate emails as separate files, use the following command:

```sh
  $ gradlew generateAllSeparatePages
```

The generated HTML emails will be saved as HTML documents in the `/email/individual/` folder.

To generate emails in a single file, use the following command:

```sh
  $ gradlew generateAllSinglePage
```

The generated HTML emails will be saved as HTML documents in `/email/all-in-one.html`

To deploy on a local PageSeeder installation, use the following command:

```sh
  $ gradlew installOnLocalPageSeeder
```

## Customize the emails

The actual HTML email templates are in `/src/main/template/html/`.

When the SDK is used for the first time, the default templates located in
`/src/main/defaults/html/` are copied to `/src/main/template/html/`
which contains main files to modify are in `/src/main/template/html/`.

The XML generated by PageSeeder as a source for the email templates is stored in the
`/src/main/message/` folder and is used as a source for the templates. There is no reason 
to modify it and it should cover most use cases.

### `_custom.xsl`

This module defines the header and footer for all emails, logo/branding.
Any custom templates should be defined here are this makes it easier to upgrade templates in the future.

### `styles.css`

This stylesheet defines most of the styles used for emails.
It is useful to modify this stylesheet to change color scheme.

### individual notification templates

Individual templates can be modified to change:
 - the wording
 - the links and button so that they point to the correct location


## file organisation

The files are organized as follows:

```
/src
   /main
      /defaults   Default templates (copied to template/html the first time)
      /message    Source XML generated by PageSeeder
      /template   
         /html    XSLT templates for HTML emails
      /xslt       XSLT used for the SDK (do not modify)
/email            Generated HTML for emails 
```

## Conventions

The XSLT modules starting with `_` (underscore) provide common reusable templates and function.
They should generally not be modified except for 


## Limitations

 - Due to a bug before PageSeeder 5.9, sample templates incorrectly use the `@name` attributes 
   instead of the template attribute
 - In order for templates to be generated all notification templates must be qualified using the
   `@template` attribute
 - Numerous limitations when writing CSS see the `_inliner.xsl` file for details
 - Saxon throws warning dues to the same modules imported multiple times, it is harmless


## Future development

 - Support TEXT templates
 - Remove all legacy templates
 - Simplify CSS and remove most inline styles from existing code
 - Improve responsiveness
 - Generate `.eml` files so that generated HTML can be tested directly in Outlook
 - Improve inliner to take advantage of well tested frameworks (e.g. Foundation Ink)
 - Better handling of images (offline / online)
 - Install on remote servers
 - Automatically send test templates with PageSeeder 
 - Detect CSS properties which aren't supported by some clients (e.g. `padding` on `p` for Outlook)


